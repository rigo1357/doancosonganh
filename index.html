<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PPTLaptop - Trang ch·ªß</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
    <div class="container header-inner">
      <div class="brand">
        <div class="logo" style="padding:0;overflow:hidden;display:flex;align-items:center;justify-content:center">
          <a href="index.html" style="display:block;width:100%;height:100%">
            <img src="Image/Logo.jpg" alt="Logo PPTLaptop" style="width:100%;height:100%;object-fit:contain;" />
          </a>
        </div>
        <div>
          <div class="brand-title">PPTStore</div>
          <div class="brand-sub">Mua laptop - giao t·∫≠n n∆°i</div>
        </div>
      </div>
      <div class="search">
          <input id="search" placeholder="üîç T√¨m ki·∫øm laptop..." autocomplete="off" />
          <div id="search-results" style="position:absolute;left:0;right:0;top:110%;z-index:1000;background:#fff;border-radius:0 0 10px 10px;box-shadow:0 4px 16px rgba(0,0,0,0.08);display:none;max-height:340px;overflow:auto;padding:8px 0;"></div>
        </div>
      <nav class="nav">
        <a href="index.html" class="active">Trang ch·ªß</a>
        <div class="dropdown">
          <a href="products.html" class="dropdown-toggle">S·∫£n ph·∫©m</a>
          <div class="dropdown-menu mega-menu">
            <div class="mega-col">
              <div class="mega-title">Laptop Dell</div>
              <a href="#">Dell Alienware</a>
              <a href="#">Dell Precision</a>
              <a href="#">Dell XPS</a>
              <a href="#">Dell Vostro</a>
              <a href="#">Dell Inspiron</a>
              <a href="#">Dell Latitude</a>
              <a href="#">Dell G-Seri</a>
            </div>
            <div class="mega-col">
              <div class="mega-title">Laptop Acer</div>
              <a href="#">Acer Aspire</a>
              <a href="#">Acer Nitro</a>
              <a href="#">Acer Spin</a>
              <a href="#">Acer Predator</a>
              <a href="#">Acer Swift</a>
            </div>
            <div class="mega-col">
              <div class="mega-title">Laptop Asus</div>
              <a href="#">Asus Tuf</a>
              <a href="#">Asus ZenBook</a>
              <a href="#">Asus VivoBook</a>
              <a href="#">Asus Rog</a>
            </div>
            <div class="mega-col">
              <div class="mega-title">Laptop Lenovo</div>
              <a href="#">Lenovo Ideapad</a>
              <a href="#">Lenovo ThinkBook</a>
              <a href="#">Lenovo Yoga</a>
              <a href="#">Lenovo Legion</a>
              <a href="#">Lenovo Thinkpad</a>
              <a href="#">Lenovo LOQ</a>
            </div>
            <div class="mega-col">
              <div class="mega-title">Laptop HP</div>
              <a href="#">HP Elitebook</a>
              <a href="#">HP Spectre</a>
              <a href="#">HP Pavilion</a>
              <a href="#">HP Probook</a>
              <a href="#">HP Omen</a>
              <a href="#">HP Envy</a>
              <a href="#">HP Zbook</a>
            </div>
            <div class="mega-col">
              <div class="mega-title">Laptop MSI</div>
              <a href="#">MSI G-Seri</a>
              <a href="#">MSI Bravo</a>
              <a href="#">MSI Modern</a>
            </div>
          </div>
        </div>
        <a href="contact.html">Li√™n h·ªá</a>
        <a href="Login.html" id="login-link" title="ƒêƒÉng nh·∫≠p/ƒêƒÉng k√Ω" style="display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:8px;background:#f5f7fa;">
          <img src="Image/Icon/Login.png" alt="ƒêƒÉng nh·∫≠p" style="width:22px;height:22px;vertical-align:middle;">
        </a>
        <span id="user-info" class="user-info"></span>
        <a href="cart.html">üõí Gi·ªè (<span id="cart-count">0</span>)</a>
<a href="#" id="logout-link" class="logout" title="ƒêƒÉng xu·∫•t" style="display:none;align-items:center;gap:6px;padding:6px 12px;border-radius:8px;background:#f5f7fa;">
  <img src="Image/Icon/logout.jpg" alt="ƒêƒÉng xu·∫•t" style="width:22px;height:22px;vertical-align:middle;">
</a>
      </nav>
    </div>


  </header>

  <!-- S·∫£n ph·∫©m -->
<!-- Carousel -->
<main class="container">
  <div class="carousel">
    <button class="carousel-btn prev" id="prevBtn" aria-label="Tr∆∞·ªõc" style="position:absolute;left:10px;top:50%;transform:translateY(-50%);z-index:2;background:rgba(0,0,0,0.5);color:#fff;font-size:22px;padding:8px 12px;border-radius:50%;border:none;cursor:pointer;">&#8592;</button>
    <button class="carousel-btn next" id="nextBtn" aria-label="Sau" style="position:absolute;right:10px;top:50%;transform:translateY(-50%);z-index:2;background:rgba(0,0,0,0.5);color:#fff;font-size:22px;padding:8px 12px;border-radius:50%;border:none;cursor:pointer;">&#8594;</button>
    <div class="carousel-track" id="carousel-track">
      <div class="carousel-slide"><img src="/Image/khuyenmai/thumb_salelaptop_800x450.png" alt="Banner 1"></div>
      <div class="carousel-slide"><img src="/Image/khuyenmai/tet2_800x450.jpg" alt="Banner 2"></div>
      <div class="carousel-slide"><img src="/Image/khuyenmai/laptop_cu_800x450.jpg" alt="Banner 3"></div>
      <div class="carousel-slide"><img src="/Image/khuyenmai/800-4509_800x450.png" alt="Banner 4"></div>
    </div>
    <div class="carousel-dots" id="carousel-dots"></div>
  </div>

  <!-- S·∫£n ph·∫©m n·ªïi b·∫≠t -->
<section style="margin-top:32px">
  <h2 class="section-title">
    <a href="pd/products-study.html">H·ªçc t·∫≠p - VƒÉn ph√≤ng</a>
  </h2>
  <div class="grid" id="cat-study"></div>
</section>

<section style="margin-top:32px">
  <h2 class="section-title">
    <a href="pd/products-gaming.html">Laptop Gaming</a>
  </h2>
  <div class="grid" id="cat-gaming"></div>
</section>

<section style="margin-top:32px">
  <h2 class="section-title">
    <a href="pd/products-design.html">Laptop ƒê·ªì h·ªça</a>
  </h2>
  <div class="grid" id="cat-design"></div>
</section>

<section style="margin-top:32px">
  <h2 class="section-title">
    <a href="pd/products-ultra.html">Laptop M·ªèng nh·∫π cao c·∫•p</a>
  </h2>
  <div class="grid" id="cat-ultra"></div>
</section>

</main>




  <!-- Footer m·ªõi hi·ªán ƒë·∫°i -->
  <footer>

    <div class="footer-main">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h6>PPTLaptop</h6>
            <p>ƒê·ªãa ch·ªâ: 06 Tr·∫ßn VƒÉn ∆†n, Ph√∫ Ho√†, Th·ªß D·∫ßu M·ªôt, B√¨nh D∆∞∆°ng, Vi·ªát Nam</p>
            <p>Hotline: 0971 476 878</p>
            <p>Email: pptlaptop@gmail.com</p>
            <div style="margin-top:8px">
              <iframe
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3918.996246850356!2d106.6747335!3d10.979613!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3174d1276f4b7577%3A0x54075879a0f2301!2s06%20Tr%E1%BA%A7n%20V%C4%83n%20%C6%A0n%2C%20Ph%C3%BA%20Ho%C3%A0%2C%20Th%E1%BB%A7%20D%E1%BA%A7u%20M%E1%BB%99t%2C%20B%C3%ACnh%20D%C6%B0%C6%A1ng%2C%20Vi%E1%BB%87t%20Nam!5e0!3m2!1svi!2s!4v1727111111111!5m2!1svi!2s"
                width="250"
                height="180"
                style="border:0;border-radius:8px;"
                allowfullscreen=""
                loading="lazy"
                referrerpolicy="no-referrer-when-downgrade">
              </iframe>
            </div>
          </div>
          <div class="footer-section">
            <h6>TH√îNG TIN C√îNG TY</h6>
            <ul>
              <li><a href="#">Gi·ªõi thi·ªáu c√¥ng ty</a></li>
              <li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
              <li><a href="tel:0971476878">G·ª≠i g√≥p √Ω, khi·∫øu n·∫°i</a></li>
            </ul>
          </div>
          <div class="footer-section">
            <h6>CH√çNH S√ÅCH C√îNG TY</h6>
            <ul>
              <li><a href="#">Ch√≠nh s√°ch ch·∫•t l∆∞·ª£ng</a></li>
              <li><a href="#">Ch√≠nh s√°ch b·∫£o h√†nh</a></li>
              <li><a href="#">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="container">
        <p>&copy; 2025 PPTLaptop. All Rights Reserved</p>
      </div>
    </div>
  </footer>

  <style>
    /* Footer policy section */
  

    /* ·∫¢nh trong carousel lu√¥n tr√†n khung, kh√¥ng th·ª´a vi·ªÅn tr·∫Øng */
           .carousel {
              width: 100%;
              max-width: 100%;
              height: 600px;
              position: relative;
              overflow: hidden;
              border-radius: 18px;
              background: #fff;
            }
    .carousel-track {
      height: 100%;
      display: flex;
    }
    .carousel-slide {
      height: 100%;
      min-width: 100%;
      display: flex;
      align-items: stretch;
      justify-content: center;
    }
    .carousel-slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 18px;
      background: #fff;
    }
  </style>



<div id="chatbox">
  <div class="header" id="chat-toggle">üí¨ H·ªó tr·ª£ ‚Äî PPTLaptop</div>
  <div class="body" id="chat-body" style="display:none">
    <div id="messages"><div class="msg bot">Ch√†o b·∫°n! Shop c√≥ th·ªÉ gi√∫p g√¨?</div></div>
  </div>
  <div class="input" id="chat-input-area" style="display:none">
    <textarea id="chat-input" placeholder="G√µ c√¢u h·ªèi..." rows="1"></textarea>
    <button id="chat-send">G·ª≠i</button>
  </div>
</div>



<script type="module">
    /* ------------------------
       D·ªØ li·ªáu s·∫£n ph·∫©m m·∫´u
    -------------------------*/
  import { products } from '/products.js';


  function money(v){ return v.toLocaleString('vi-VN') + ' ‚Ç´'; }

  function renderCategory(containerId, cat){
    const container = document.getElementById(containerId);
    container.innerHTML = '';
    products.filter(p=>p.category===cat).forEach(p=>{
      const card = document.createElement('div'); 
      card.className='card';
      card.innerHTML = `
        <img src="${p.img}" alt="${p.name}" />
        <div class="title">${p.name}</div>
        <div class="desc">${p.desc} ‚Äî <span class="small text-muted">${p.brand}</span></div>
        <div class="price">${money(p.price)}</div>
        <div class="price-row">
          <button class="btn secondary">Xem</button>
        </div>
      `;
      // G√°n s·ª± ki·ªán click cho n√∫t Xem
      const btn = card.querySelector('button.btn.secondary');
      btn.addEventListener('click', () => viewDetail(p.id));
      container.appendChild(card);
    });
  }

  // G·ªçi render cho t·ª´ng section
  renderCategory('cat-study','study');
  renderCategory('cat-gaming','gaming');
  renderCategory('cat-design','design');
  renderCategory('cat-ultra','ultra');

  // H√†m render s·∫£n ph·∫©m cho t√¨m ki·∫øm
  function renderProducts(list){
    // Hi·ªÉn th·ªã s·∫£n ph·∫©m t√¨m ki·∫øm ·ªü cat-study (ho·∫∑c t·∫°o 1 khu v·ª±c ri√™ng n·∫øu mu·ªën)
    const container = document.getElementById('cat-study');
    if(!container) return;
    container.innerHTML = '';
    list.forEach(p=>{
      const card = document.createElement('div');
      card.className='card';
      card.innerHTML = `
        <img src="${p.img}" alt="${p.name}" />
        <div class="title">${p.name}</div>
        <div class="desc">${p.desc} ‚Äî <span class="small text-muted">${p.brand}</span></div>
        <div class="price">${money(p.price)}</div>
        <div class="price-row">
          <button class="btn secondary" onclick="viewDetail(${p.id})">Xem</button>
        </div>
      `;
      container.appendChild(card);
    });
  }

  // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong gi·ªè
  function updateCartCount(){
    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    let count = cart.reduce((sum, item) => sum + (item.qty || 1), 0);
    document.getElementById('cart-count').innerText = count;
  }

  // G·ªçi c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng khi load trang
  updateCartCount();

  function addToCart(id){
    const p = products.find(x=>x.id===id);
    if(!p) return alert('S·∫£n ph·∫©m kh√¥ng t·ªìn t·∫°i');
    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    // N·∫øu ƒë√£ c√≥ s·∫£n ph·∫©m th√¨ tƒÉng s·ªë l∆∞·ª£ng
    let found = cart.find(x=>x.id===id);
    if(found) found.qty = (found.qty||1) + 1;
    else cart.push({...p, qty:1});
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    alert('ƒê√£ th√™m: ' + p.name);
  }

  function viewDetail(id){
    if (!id || isNaN(id)) {
      alert('Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m!');
      return;
    }
    window.location.href = 'product-detail.html?id=' + id;
  }

  // Hi·ªÉn th·ªã k·∫øt qu·∫£ t√¨m ki·∫øm d∆∞·ªõi thanh t√¨m ki·∫øm
  const searchInput = document.getElementById('search');
  const searchResults = document.getElementById('search-results');

  searchInput.addEventListener('input', e => {
    const q = e.target.value.trim().toLowerCase();
    if (!q) {
      searchResults.style.display = 'none';
      searchResults.innerHTML = '';
      return;
    }
    const filtered = products.filter(p => (p.name + ' ' + p.desc + ' ' + p.brand).toLowerCase().includes(q));
    if (filtered.length === 0) {
      searchResults.innerHTML = '<div style="padding:12px;color:#888;text-align:center">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m</div>';
      searchResults.style.display = 'block';
      return;
    }
    searchResults.innerHTML = filtered.map(p => `
      <div class="search-item" style="display:flex;align-items:center;padding:6px 16px;gap:12px;cursor:pointer;transition:background 0.2s" onclick="window.location='product-detail.html?id=${p.id}'" onmouseover="this.style.background='#f5f7fa'" onmouseout="this.style.background='none'">
        <img src="${p.img}" alt="${p.name}" style="width:48px;height:48px;object-fit:cover;border-radius:6px;border:1px solid #eee" />
        <div style="flex:1">
          <div style="font-weight:500;font-size:15px">${p.name}</div>
          <div style="color:#1976d2;font-weight:600">${money(p.price)}</div>
          <div style="font-size:13px;color:#555;margin-top:2px">${p.desc}</div>
        </div>
      </div>
    `).join('');
    searchResults.style.display = 'block';
  });

  // ·∫®n k·∫øt qu·∫£ khi blur kh·ªèi input (tr·ª´ khi click v√†o k·∫øt qu·∫£)
  searchInput.addEventListener('blur', ()=>{
    setTimeout(()=>{ searchResults.style.display = 'none'; }, 180);
  });
  searchInput.addEventListener('focus', ()=>{
    if(searchInput.value.trim()) searchResults.style.display = 'block';
  });

  // ƒê·∫£m b·∫£o c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng khi v√†o l·∫°i trang
  window.addEventListener('storage', updateCartCount);

  const user = JSON.parse(localStorage.getItem('currentUser') || 'null');

  if(user){
    // ·∫®n n√∫t ƒëƒÉng nh·∫≠p, hi·ªán ch√†o user + ƒëƒÉng xu·∫•t
    document.getElementById('login-link').style.display = 'none';
    document.getElementById('user-info').style.display = 'inline-block';
    document.getElementById('user-info').innerText = 'Xin ch√†o, ' + user.email;
    document.getElementById('logout-link').style.display = 'inline-block';
  }

  // X·ª≠ l√Ω khi click "ƒêƒÉng xu·∫•t"
  document.getElementById('logout-link').addEventListener('click', e=>{
    e.preventDefault();
    localStorage.removeItem('currentUser'); // xo√° user
    window.location.reload(); // reload l·∫°i ƒë·ªÉ reset tr·∫°ng th√°i
  });

    /* --- Chatbox Script --- */
const chatToggle = document.getElementById('chat-toggle');
const chatBody = document.getElementById('chat-body');
const chatInputArea = document.getElementById('chat-input-area');
const messages = document.getElementById('messages');
const chatInput = document.getElementById('chat-input');
const chatSend = document.getElementById('chat-send');

let chatOpen = false;
chatToggle.addEventListener('click', ()=>{
  chatOpen = !chatOpen;
  chatBody.style.display = chatOpen ? 'block' : 'none';
  chatInputArea.style.display = chatOpen ? 'flex' : 'none';
});

function appendMsg(text, cls){
  const d = document.createElement('div');
  d.className = 'msg ' + cls;
  d.innerText = text;
  messages.appendChild(d);
  messages.parentElement.scrollTop = messages.parentElement.scrollHeight;
}

async function sendChatMessage(){
  const t = chatInput.value.trim();
  if(!t) return;
  appendMsg(t,'user');
  chatInput.value = '';
  try{
    const res = await fetch('http://127.0.0.1:5000/api/ollama', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ prompt: t })
    });
    const data = await res.json();
    appendMsg(data.reply || 'Xin l·ªói, ch∆∞a c√≥ ph·∫£n h·ªìi.','bot');
  }catch(err){
    console.error('Chatbox error:', err);
    appendMsg('‚ö†Ô∏è Kh√¥ng th·ªÉ k·∫øt n·ªëi m√°y ch·ªß.','bot');
  }
}

chatSend.addEventListener('click', sendChatMessage);
chatInput.addEventListener('keydown', e=>{
  if(e.key==='Enter') sendChatMessage();
});

/* --- Carousel Script --- */
const track = document.getElementById('carousel-track');
const slides = document.querySelectorAll('.carousel-slide');
const dotsContainer = document.getElementById('carousel-dots');

let currentIndex = 0;
let autoSlide;

// t·∫°o dots
slides.forEach((_, i) => {
  const dot = document.createElement('span');
  if (i === 0) dot.classList.add('active');
  dot.addEventListener('click', ()=> goToSlide(i));
  dotsContainer.appendChild(dot);
});

function updateCarousel(){
  track.style.transform = `translateX(-${currentIndex * 100}%)`;
  document.querySelectorAll('.carousel-dots span').forEach((d,i)=>{
    d.classList.toggle('active', i===currentIndex);
  });
}

function goToSlide(i){
  currentIndex = (i + slides.length) % slides.length;
  updateCarousel();
}

// --- SWIPE (Touch + Mouse Drag) ---
let startX = 0, endX = 0, isDragging = false;
// Touch events
track.addEventListener('touchstart', e => {
  startX = e.touches[0].clientX;
  isDragging = true;
});
track.addEventListener('touchmove', e => {
  if (!isDragging) return;
  endX = e.touches[0].clientX;
});
track.addEventListener('touchend', () => {
  if (!isDragging) return;
  if (startX - endX > 50) goToSlide(currentIndex + 1);
  else if (endX - startX > 50) goToSlide(currentIndex - 1);
  isDragging = false;
});
// Mouse events
track.addEventListener('mousedown', e => {
  startX = e.clientX;
  isDragging = true;
});
track.addEventListener('mousemove', e => {
  if (!isDragging) return;
  endX = e.clientX;
});
track.addEventListener('mouseup', () => {
  if (!isDragging) return;
  if (startX - endX > 50) goToSlide(currentIndex + 1);
  else if (endX - startX > 50) goToSlide(currentIndex - 1);
  isDragging = false;
});
track.addEventListener('mouseleave', () => {
  isDragging = false;
});

// N√∫t m≈©i t√™n chuy·ªÉn slide
document.getElementById('prevBtn').addEventListener('click', () => goToSlide(currentIndex - 1));
document.getElementById('nextBtn').addEventListener('click', () => goToSlide(currentIndex + 1));

/* ----- AUTO SLIDE ----- */
function startAutoSlide(){
  autoSlide = setInterval(()=> goToSlide(currentIndex + 1), 5000);
}
function stopAutoSlide(){
  clearInterval(autoSlide);
}
document.querySelector('.carousel').addEventListener('mouseenter', stopAutoSlide);
document.querySelector('.carousel').addEventListener('mouseleave', startAutoSlide);

updateCarousel();
startAutoSlide();
</script>
</body>
</html>
