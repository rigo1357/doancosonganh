<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PPTLaptop - Trang ch·ªß</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="brand">
        <div class="logo">PL</div>
        <div>
          <div style="font-weight:700">PPTLaptop</div>
          <div style="font-size:12px;color:var(--muted)">Mua laptop - giao t·∫≠n n∆°i</div>
        </div>
      </div>

      <nav>
        <a href="index.html">Trang ch·ªß</a>
        <a href="products.html">S·∫£n ph·∫©m</a>
        <a href="contact.html">Li√™n h·ªá</a>
        <a href="Login.html" id="login-link">ƒêƒÉng nh·∫≠p/ƒêƒÉng k√Ω</a>
        <span id="user-info" style="margin-left:12px;display:none;color:var(--primary);font-weight:600"></span>
        <a href="cart.html" style="margin-left:12px">Gi·ªè (<span id="cart-count">0</span>)</a>
        <a href="#" id="logout-link" style="margin-left:12px;display:none;color:red;font-weight:600">ƒêƒÉng xu·∫•t</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="search">
        <input id="search" placeholder="T√¨m ki·∫øm ..." />
      </div>
      <div class="cart-mini">
        <div style="font-weight:700">Gi·ªè h√†ng</div>
        <div class="small text-muted" id="cart-mini-count">0 s·∫£n ph·∫©m</div>
      </div>
    </section>

    <section>
      <h3>S·∫£n ph·∫©m n·ªïi b·∫≠t</h3>
      <div class="grid" id="product-list"></div>
    </section>
  </main>

<footer>
  <div class="container footer-grid">
    <div>
      <h4>Li√™n h·ªá</h4>
      <p>üìû 0971 476 878</p>
      <p>üìß pptlaptop@gmail.com</p>
    </div>
    <div>
      <h4>ƒê·ªãa ch·ªâ</h4>
      <p class="small text-muted">06 Tr·∫ßn VƒÉn ∆†n, Ph√∫ Ho√†, Th·ªß D·∫ßu M·ªôt, B√¨nh D∆∞∆°ng, Vi·ªát Nam</p>
      <div style="margin-top:8px">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3918.996246850356!2d106.6747335!3d10.979613!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3174d1276f4b7577%3A0x54075879a0f2301!2s06%20Tr%E1%BA%A7n%20V%C4%83n%20%C6%A0n%2C%20Ph%C3%BA%20Ho%C3%A0%2C%20Th%E1%BB%A7%20D%E1%BA%A7u%20M%E1%BB%99t%2C%20B%C3%ACnh%20D%C6%B0%C6%A1ng%2C%20Vi%E1%BB%87t%20Nam!5e0!3m2!1svi!2s!4v1727111111111!5m2!1svi!2s"
          width="250"
          height="180"
          style="border:0;border-radius:8px;"
          allowfullscreen=""
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>
    </div>
  </div>

  <!-- Ph·∫ßn b·∫£n quy·ªÅn cƒÉn gi·ªØa -->
  <div style="text-align:center; color:#888; margin:12px auto 0; font-size:13px; width:100%;">
    &copy; 2025 PPTLaptop. All rights reserved.
  </div>
</footer>



  <!-- Chatbox -->
  <style>
    #chatbox { position: fixed; right: 18px; bottom: 18px; width:320px; max-height:420px; display:flex;flex-direction:column;border-radius:12px;overflow:hidden;box-shadow:0 10px 30px rgba(10,20,60,0.15);z-index:9999; font-family:sans-serif }
    #chatbox .header { background:#1976d2; color:#fff;padding:10px;font-weight:700; cursor:pointer }
    #chatbox .body { background:#fff;padding:10px;flex:1;overflow:auto;font-size:14px }
    #chatbox .input { display:flex;border-top:1px solid #eee;background:#fafafa;padding:8px }
    #chatbox input { flex:1;padding:8px;border-radius:8px;border:1px solid #e6e9ee;margin-right:8px }
    #chatbox button { padding:8px 10px;border-radius:8px;border:none;background:#1976d2;color:#fff;cursor:pointer }
    .msg { margin:6px 0;padding:8px;border-radius:8px;max-width:82% }
    .msg.user { background:#eef6ff;margin-left:auto }
    .msg.bot { background:#f1f6ee }
  </style>

<div id="chatbox">
  <div class="header" id="chat-toggle">üí¨ H·ªó tr·ª£ ‚Äî PPTLaptop</div>
  <div class="body" id="chat-body" style="display:none">
    <div id="messages"><div class="msg bot">Ch√†o b·∫°n! Shop c√≥ th·ªÉ gi√∫p g√¨?</div></div>
  </div>
  <div class="input" id="chat-input-area" style="display:none">
    <textarea id="chat-input" placeholder="G√µ c√¢u h·ªèi..." rows="1"></textarea>
    <button id="chat-send">G·ª≠i</button>
  </div>
</div>



  <script>
    /* ------------------------
       D·ªØ li·ªáu s·∫£n ph·∫©m m·∫´u
    -------------------------*/
    const products = [
      {id:1, name:'Asus TUF Gaming A15', brand:'Asus', price:24800000, desc:'Ryzen 7, 16GB RAM, RTX3050, 512GB SSD', img:'Image/Asus.webp'},
      {id:2, name:'Dell Inspiron 15', brand:'Dell', price:16800000, desc:'Intel i5, 8GB RAM, 256GB SSD', img:'Image/LaptopDell.webp'},
      {id:3, name:'HP Pavilion 14', brand:'HP', price:14900000, desc:'Intel i3, 8GB RAM, 256GB SSD', img:'Image/HP.jpg'},
      {id:4, name:'MacBook Air M2', brand:'Apple', price:27900000, desc:'Apple M2, 8GB, 256GB SSD', img:'Image/MacBook.webp'},
      {id:5, name:'Lenovo IdeaPad 3', brand:'Lenovo', price:11900000, desc:'Ryzen 5, 8GB RAM, 512GB SSD', img:'Image/Lenovo.webp'},
      {id:6, name:'Asus Vivobook 15', brand:'Asus', price:12900000, desc:'Intel i5, 8GB RAM, 512GB SSD', img:'Image/Asus.webp'}
    ];

    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
    function updateCartCount(){
      document.getElementById('cart-count').innerText = cart.length;
      document.getElementById('cart-mini-count').innerText = cart.length + ' s·∫£n ph·∫©m';
      document.getElementById('cart-mini-count').classList.toggle('text-muted', cart.length===0);
      localStorage.setItem('cart', JSON.stringify(cart));
    }
    updateCartCount();

    function money(v){ return v.toLocaleString('vi-VN') + ' ‚Ç´'; }
    function renderProducts(list){
      const container = document.getElementById('product-list');
      container.innerHTML = '';
      list.slice(0,6).forEach(p=>{
        const card = document.createElement('div'); card.className='card';
        card.innerHTML = `
          <img src="${p.img}" alt="${p.name}" />
          <div class="title">${p.name}</div>
          <div class="desc">${p.desc} ‚Äî <span class="small text-muted">${p.brand}</span></div>
          <div class="price-row">
            <div class="price">${money(p.price)}</div>
            <div>
              <button class="btn secondary" onclick="viewDetail(${p.id})">Xem</button>
              <button class="btn" onclick="addToCart(${p.id})">Th√™m</button>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
    }
    renderProducts(products);

    function addToCart(id){
      const p = products.find(x=>x.id===id);
      if(!p) return alert('S·∫£n ph·∫©m kh√¥ng t·ªìn t·∫°i');
      cart.push({...p, qty:1});
      updateCartCount();
      alert('ƒê√£ th√™m: ' + p.name);
    }
    function viewDetail(id){
      window.location.href = 'product-detail.html?id=' + id;
    }

    document.getElementById('search').addEventListener('input', e=>{
      const q = e.target.value.trim().toLowerCase();
      if(!q){ renderProducts(products); return; }
      const filtered = products.filter(p => (p.name + ' ' + p.desc + ' ' + p.brand).toLowerCase().includes(q));
      renderProducts(filtered);
    });

const user = JSON.parse(localStorage.getItem('currentUser') || 'null');

if(user){
  // ·∫®n n√∫t ƒëƒÉng nh·∫≠p, hi·ªán ch√†o user + ƒëƒÉng xu·∫•t
  document.getElementById('login-link').style.display = 'none';
  document.getElementById('user-info').style.display = 'inline-block';
  document.getElementById('user-info').innerText = 'Xin ch√†o, ' + user.email;
  document.getElementById('logout-link').style.display = 'inline-block';
}

// X·ª≠ l√Ω khi click "ƒêƒÉng xu·∫•t"
document.getElementById('logout-link').addEventListener('click', e=>{
  e.preventDefault();
  localStorage.removeItem('currentUser'); // xo√° user
  window.location.reload(); // reload l·∫°i ƒë·ªÉ reset tr·∫°ng th√°i
});

    /* --- Chatbox Script --- */
const chatToggle = document.getElementById('chat-toggle');
const chatBody = document.getElementById('chat-body');
const chatInputArea = document.getElementById('chat-input-area');
const messages = document.getElementById('messages');
const chatInput = document.getElementById('chat-input');
const chatSend = document.getElementById('chat-send');

let chatOpen = false;
chatToggle.addEventListener('click', ()=>{
  chatOpen = !chatOpen;
  chatBody.style.display = chatOpen ? 'block' : 'none';
  chatInputArea.style.display = chatOpen ? 'flex' : 'none';
});

function appendMsg(text, cls){
  const d = document.createElement('div');
  d.className = 'msg ' + cls;
  d.innerText = text;
  messages.appendChild(d);
  messages.parentElement.scrollTop = messages.parentElement.scrollHeight;
}

async function sendChatMessage(){
  const t = chatInput.value.trim();
  if(!t) return;
  appendMsg(t,'user');
  chatInput.value = '';
  try{
    const res = await fetch('http://127.0.0.1:5000/api/ollama', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ prompt: t })
    });
    const data = await res.json();
    appendMsg(data.reply || 'Xin l·ªói, ch∆∞a c√≥ ph·∫£n h·ªìi.','bot');
  }catch(err){
    console.error('Chatbox error:', err);
    appendMsg('‚ö†Ô∏è Kh√¥ng th·ªÉ k·∫øt n·ªëi m√°y ch·ªß.','bot');
  }
}

chatSend.addEventListener('click', sendChatMessage);
chatInput.addEventListener('keydown', e=>{
  if(e.key==='Enter') sendChatMessage();
});


</script>
</body>
</html>
